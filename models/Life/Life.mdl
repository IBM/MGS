// =============================================================================
// (C) Copyright IBM Corp. 2005-2025. All rights reserved.
//
// Distributed under the terms of the Apache License
// Version 2.0, January 2004.
// (See accompanying file LICENSE or copy at http://www.apache.org/licenses/.)
//
// =============================================================================
#ifndef LIFENODE_MDL
#define LIFENODE_MDL
#include "../PointNeuronTools/PointNeuronTools.mdl"

//{{{
//Node LifeNode Implements ValueProducer{
//   int value;
//   int publicValue;
//   int* [] neighbors;
//
//   Shared {
//     int tooSparse;
//     int tooCrowded;
//     int actionType;
//	   int complexity;
//   }
//
//   InitPhase initialize();
//   RuntimePhase update();
//   RuntimePhase updateWeight();
//   RuntimePhase copy(publicValue);
//
//   ValueProducer.value << &publicValue;
//   
//
//   Connection Pre Node () Expects ValueProducer {
//      ValueProducer.value >> neighbors;
//   }
//}
//}}}
Node LifeNode Implements ValueProducer, FloatProducer {
   //{{{internal data 
   int value;
   int publicValue;
   float weight;
   float publicWeight;
   //}}}
   int* [] neighbors;
   float* [] neighborsWeight;

   Shared {
     //{{{
     int tooSparse;
     int tooCrowded;
     int actionType;
     int complexity;
     //}}}
   }

   InitPhase initialize();
   RuntimePhase update();
   RuntimePhase updateWeight();
   RuntimePhase copy(publicValue, publicWeight);
   //values passed to here will be marshalled-demarshalled 
   // if the two neighbors are on different memory spaces

   ValueProducer.value << &publicValue;
   FloatProducer.value << &publicWeight;
   

   Connection Pre Node () Expects ValueProducer, FloatProducer {
      ValueProducer.value >> neighbors;
      FloatProducer.value >> neighborsWeight;
   }
}
#endif
